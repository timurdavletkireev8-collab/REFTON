<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            background-color: #000; 
            color: #fff; 
            font-family: sans-serif; 
        }
        /* Управление вкладками */
        .tab-content { 
            display: none; 
        }
        .tab-content.active { 
            display: block; 
        }
        /* Стили для модального окна */
        .modal { 
            display: none; 
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.8); 
            align-items: center; 
            justify-content: center; 
            z-index: 50; 
        }
        .modal.active { 
            display: flex; 
        }
    </style>
</head>
<body>

    <div id="app" class="pb-20">
        
        <div id="profile" class="tab-content active p-6 text-center">
            <h1 class="text-2xl font-bold mb-4">Profile</h1>
            
            <div class="bg-gray-900 rounded-3xl p-8 mb-6 flex flex-col items-center">
                <p class="text-gray-400 mb-2">Ваш баланс</p>
                <h2 id="balance-display" class="text-4xl font-extrabold mb-6">0.00 TON</h2>
                
                <button onclick="openWalletModal()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full transition-all w-full max-w-[250px]">
                    Привязать кошелёк
                </button>
                <p id="wallet-status" class="mt-4 text-sm text-green-400 hidden">Кошелёк подключен: <span id="addr-preview"></span></p>
            </div>

            <div class="space-y-4 text-left">
                <div class="bg-gray-800 p-4 rounded-xl flex justify-between items-center cursor-pointer hover:bg-gray-700 transition-colors">
                    <span>Статистика</span>
                    <span class="text-blue-400">→</span>
                </div>
                <div class="bg-gray-800 p-4 rounded-xl flex justify-between items-center cursor-pointer hover:bg-gray-700 transition-colors">
                    <span>Настройки</span>
                    <span class="text-blue-400">→</span>
                </div>
            </div>
        </div>

        <div id="tasks" class="tab-content p-6">
            <h1 class="text-2xl font-bold mb-4">Задания</h1>
            <div class="bg-gray-900 rounded-2xl p-4 text-center text-gray-400">
                Здесь будет список заданий
            </div>
        </div>
    </div>

    <div id="wallet-modal" class="modal">
        <div class="bg-gray-900 p-6 rounded-2xl w-80 border border-gray-700">
            <h3 class="text-xl font-bold mb-4 text-center">Выберите кошелёк</h3>
            <div class="space-y-3">
                <button onclick="connectWallet('Tonkeeper')" class="w-full bg-gray-800 p-3 rounded-lg flex items-center gap-3 hover:bg-gray-700 transition-colors">
                    <div class="w-8 h-8 bg-blue-500 rounded-full"></div> Tonkeeper
                </button>
                <button onclick="connectWallet('MyTonWallet')" class="w-full bg-gray-800 p-3 rounded-lg flex items-center gap-3 hover:bg-gray-700 transition-colors">
                    <div class="w-8 h-8 bg-blue-400 rounded-full"></div> MyTonWallet
                </button>
                <button onclick="connectWallet('Telegram Wallet')" class="w-full bg-gray-800 p-3 rounded-lg flex items-center gap-3 hover:bg-gray-700 transition-colors">
                    <div class="w-8 h-8 bg-blue-300 rounded-full"></div> Telegram Wallet
                </button>
            </div>
            <button onclick="closeWalletModal()" class="mt-4 w-full text-gray-400 text-sm hover:text-white transition-colors">Отмена</button>
        </div>
    </div>

    <nav class="fixed bottom-0 left-0 right-0 bg-gray-900 border-t border-gray-800 flex justify-around p-4 z-40">
        <button onclick="showTab('tasks')" class="flex flex-col items-center text-gray-400 hover:text-blue-500 transition-colors">
            <span class="text-sm font-medium">Tasks</span>
        </button>
        <button onclick="showTab('profile')" class="flex flex-col items-center text-blue-500 hover:text-blue-400 transition-colors">
            <span class="text-sm font-medium">Profile</span>
        </button>
    </nav>

    <script>
        // --- МОДУЛЬ БАЗЫ ДАННЫХ (DB Engine на базе localStorage) ---
        const DB = {
            save(key, data) {
                localStorage.setItem(key, JSON.stringify(data));
            },
            load(key) {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : null;
            },
            // Инициализация данных пользователя при первом входе
            initUser() {
                let user = this.load('user_data');
                if (!user) {
                    user = {
                        balance: 150.50, // Стартовый баланс
                        wallet: null,
                        connected: false
                    };
                    this.save('user_data', user);
                }
                return user;
            },
            // Обновление конкретных данных пользователя
            updateUser(newData) {
                const current = this.initUser();
                const updated = { ...current, ...newData };
                this.save('user_data', updated);
                return updated;
            }
        };

        // --- ЛОГИКА ПРИЛОЖЕНИЯ ---

        // Функция запуска при загрузке страницы
        function init() {
            const user = DB.initUser();
            // Выводим баланс из базы данных
            document.getElementById('balance-display').innerText = `${user.balance.toFixed(2)} TON`;
            
            // Проверяем, привязан ли уже кошелек
            if (user.connected) {
                showWalletStatus(user.wallet);
            }
        }

        // Переключение вкладок в нижнем меню
        function showTab(tabId) {
            // Скрываем все вкладки
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            // Показываем нужную
            document.getElementById(tabId).classList.add('active');
            
            // Обновляем цвета кнопок в меню (простая визуализация)
            const navButtons = document.querySelectorAll('nav button');
            navButtons.forEach(btn => {
                btn.classList.remove('text-blue-500');
                btn.classList.add('text-gray-400');
            });
            event.currentTarget.classList.remove('text-gray-400');
            event.currentTarget.classList.add('text-blue-500');
        }

        // Открытие модального окна выбора кошелька
        function openWalletModal() {
            document.getElementById('wallet-modal').classList.add('active');
        }

        // Закрытие модального окна
        function closeWalletModal() {
            document.getElementById('wallet-modal').classList.remove('active');
        }

        // Функция привязки кошелька
        function connectWallet(name) {
            // Сохраняем информацию о привязанном кошельке в нашу базу данных
            DB.updateUser({
                wallet: name,
                connected: true
            });

            // Обновляем интерфейс
            showWalletStatus(name);
            closeWalletModal();
            
            // Небольшое уведомление
            alert(`Кошелёк ${name} успешно привязан! Данные сохранены в базе.`);
        }

        // Обновление UI после привязки
        function showWalletStatus(name) {
            const status = document.getElementById('wallet-status');
            const preview = document.getElementById('addr-preview');
            status.classList.remove('hidden');
            preview.innerText = name;
        }

        // Запуск инициализации при загрузке документа
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>

